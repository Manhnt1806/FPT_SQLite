IF OBJECT_ID('THUOC') IS NOT NULL
	DROP TABLE THUOC
GO
CREATE TABLE THUOC (
	MATHUOC varchar(10) PRIMARY KEY NOT NULL,
	TENTH nvarchar(20) NOT NULL,
	DVT nvarchar(10) NOT NULL,
	GIA int,
	NHOMDTRI nvarchar(20) NOT NULL,
)
IF OBJECT_ID('HOSO') IS NOT NULL
	DROP TABLE HOSO
GO
CREATE TABLE HOSO (
	MAHS varchar(10) PRIMARY KEY NOT NULL,
	HOTEN nvarchar(30) NOT NULL,
	NGSINH date,
	GIOITINH varchar(10) NOT NULL,
	CMND nvarchar(20) NOT NULL,
	NGLAP date,
)
IF OBJECT_ID('KHAMBENH') IS NOT NULL
	DROP TABLE KHAMBENH
GO
CREATE TABLE KHAMBENH (
	MAKB varchar(10) PRIMARY KEY NOT NULL,
	MAHS varchar(10),
	NGKHAM date,
	BACSI varchar(20) NOT NULL,
	KETLUAN nvarchar(30) NOT NULL,
)
IF OBJECT_ID('TOATHUOC') IS NOT NULL
	DROP TABLE TOATHUOC
GO
CREATE TABLE TOATHUOC (
	MAKB varchar(10),
	MATHUOC varchar(10),
	SOLUONG int,
)
ALTER TABLE KHAMBENH ADD FOREIGN KEY(MAHS) REFERENCES HOSO
ALTER TABLE TOATHUOC ADD FOREIGN KEY(MAKB) REFERENCES KHAMBENH
ALTER TABLE TOATHUOC ADD FOREIGN KEY(MATHUOC) REFERENCES THUOC

INSERT INTO THUOC(MATHUOC, TENTH, DVT, GIA, NHOMDTRI) VALUES('TH01', 'Men tiêu hóa', 'Viên', 1000, 'Tiêu hóa')
INSERT INTO THUOC(MATHUOC, TENTH, DVT, GIA, NHOMDTRI) VALUES('TH02', 'Becbezine', 'Viên', 1200, 'Tiêu hóa')
INSERT INTO THUOC(MATHUOC, TENTH, DVT, GIA, NHOMDTRI) VALUES('TH03', 'Smecta', 'Gói',500, 'Tiêu hóa')
INSERT INTO THUOC(MATHUOC, TENTH, DVT, GIA, NHOMDTRI) VALUES('TH04', 'Panadol', 'Viên', 2000, 'Hạ sốt, giảm đau')
INSERT INTO THUOC(MATHUOC, TENTH, DVT, GIA, NHOMDTRI) VALUES('TH05', 'Efferalgan', 'Viên', 4000, 'Hạ sốt, giảm đau')
INSERT INTO THUOC(MATHUOC, TENTH, DVT, GIA, NHOMDTRI) VALUES('TH06', 'Clorpheniramin', 'Viên', 1000, 'Dị ứng')

INSERT INTO HOSO(MAHS, HOTEN, NGSINH, GIOITINH, CMND,NGLAP) VALUES('020', 'Vũ Thị Thúy', '1993-05-10', 'Nữ','00052681001','2007-06-01')
INSERT INTO HOSO(MAHS, HOTEN, NGSINH, GIOITINH, CMND,NGLAP) VALUES('021', 'Nguyễn Minh Thúy', '1968-08-10', 'Nữ','12311112324','2008-09-11')
INSERT INTO HOSO(MAHS, HOTEN, NGSINH, GIOITINH, CMND,NGLAP) VALUES('022', 'Nguyễn Văn Long', '1966-05-13', 'Nam','091827481914','2005-06-21')
INSERT INTO HOSO(MAHS, HOTEN, NGSINH, GIOITINH, CMND,NGLAP) VALUES('023', 'Nguyễn Văn Lương', '1991-09-25', 'Nam','827681901823','2012-06-12')
INSERT INTO HOSO(MAHS, HOTEN, NGSINH, GIOITINH, CMND,NGLAP) VALUES('024', 'Nguyễn Anh Duy', '2020-01-12', 'Nam','112381728144','2022-06-09')
INSERT INTO HOSO(MAHS, HOTEN, NGSINH, GIOITINH, CMND,NGLAP) VALUES('025', 'Nguyễn Văn Long', '1970-07-01', 'Nam','918873917231','2021-09-25')

INSERT INTO KHAMBENH(MAKB, MAHS, NGKHAM, BACSI, KETLUAN) VALUES('KB01', '025', '2021-09-25', 'Liên','Tiêu chảy')
INSERT INTO KHAMBENH(MAKB, MAHS, NGKHAM, BACSI, KETLUAN) VALUES('KB02', '025', '2015-03-22', 'Mai','Tiêu chảy')
INSERT INTO KHAMBENH(MAKB, MAHS, NGKHAM, BACSI, KETLUAN) VALUES('KB03', '021', '2008-09-11', 'Loan','Dị ứng')
INSERT INTO KHAMBENH(MAKB, MAHS, NGKHAM, BACSI, KETLUAN) VALUES('KB04', '020', '2021-05-04', 'Huy','Cảm cúm')
INSERT INTO KHAMBENH(MAKB, MAHS, NGKHAM, BACSI, KETLUAN) VALUES('KB05', '023', '2022-08-09', 'Thiện','Cúm A')
INSERT INTO KHAMBENH(MAKB, MAHS, NGKHAM, BACSI, KETLUAN) VALUES('KB06', '021', '2020-11-01', 'Thơ','Đau dạ dày')
INSERT INTO KHAMBENH(MAKB, MAHS, NGKHAM, BACSI, KETLUAN) VALUES('KB07', '022', '2005-06-21', 'Khánh','Co thắt đại tràng')
INSERT INTO KHAMBENH(MAKB, MAHS, NGKHAM, BACSI, KETLUAN) VALUES('KB08', '025', '2005-06-21', 'Loan','Dị ứng')

INSERT INTO TOATHUOC(MAKB, MATHUOC, SOLUONG) VALUES('KB01', 'TH01', 10)
INSERT INTO TOATHUOC(MAKB, MATHUOC, SOLUONG) VALUES('KB01', 'TH02', 22)
INSERT INTO TOATHUOC(MAKB, MATHUOC, SOLUONG) VALUES('KB01', 'TH03', 10)
INSERT INTO TOATHUOC(MAKB, MATHUOC, SOLUONG) VALUES('KB03', 'TH06', 15)
INSERT INTO TOATHUOC(MAKB, MATHUOC, SOLUONG) VALUES('KB04', 'TH04', 6)
INSERT INTO TOATHUOC(MAKB, MATHUOC, SOLUONG) VALUES('KB05', 'TH05', 7)
INSERT INTO TOATHUOC(MAKB, MATHUOC, SOLUONG) VALUES('KB06', 'TH03', 30)

SELECT KB.MAHS, T.TENTH, T.MATHUOC, TH.SOLUONG FROM THUOC AS T
INNER JOIN TOATHUOC AS TH ON T.MATHUOC = TH.MATHUOC
INNER JOIN KHAMBENH AS KB ON TH.MAKB = KB.MAKB
WHERE KB.MAHS = '025'
